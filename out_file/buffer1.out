/home/intern/anaconda3/envs/distillation_ct/lib/python3.9/site-packages/torch/functional.py:568: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1646756402876/work/aten/src/ATen/native/TensorShape.cpp:2228.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
Hyper-parameters: 
 {'dataset': 'CRC', 'subset': 'imagenette', 'model': 'ResNet18', 'num_experts': 10, 'lr_teacher': 0.001, 'batch_train': 16, 'batch_real': 16, 'dsa': True, 'dsa_strategy': 'color_crop_cutout_flip_scale_rotate', 'data_path': '{path_to_dataset}', 'buffer_path': '{path_to_buffer_storage}', 'train_epochs': 50, 'zca': False, 'decay': True, 'mom': 0.9, 'l2': 0.01, 'save_interval': 1, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7faae2ecca30>}
BUILDING DATASET
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'crop_scale_rotate'}
Itr: 0	Epoch: 0	Train Acc: 0.5372559095580678	Train AUC: 0.6475336322869955
Test Acc: 0.5819784841866861	Test AUC: 0.5462577962577962
Itr: 0	Epoch: 1	Train Acc: 0.6332969338814662	Train AUC: 0.8053811659192827
Test Acc: 0.516763730486128	Test AUC: 0.6470893970893971
Itr: 0	Epoch: 2	Train Acc: 0.683281945871874	Train AUC: 0.8765695067264574
Test Acc: 0.6403785488958991	Test AUC: 0.7401247401247402
Itr: 0	Epoch: 3	Train Acc: 0.7080014559780747	Train AUC: 0.9053811659192824
Test Acc: 0.5897739221871714	Test AUC: 0.7551975051975053
Itr: 0	Epoch: 4	Train Acc: 0.7293914868105515	Train AUC: 0.9290358744394619
Test Acc: 0.6218150934239263	Test AUC: 0.7432432432432432
Itr: 0	Epoch: 5	Train Acc: 0.7403541452552244	Train AUC: 0.9325112107623318
Test Acc: 0.6167697969748442	Test AUC: 0.7614345114345114
Itr: 0	Epoch: 6	Train Acc: 0.7479659129838986	Train AUC: 0.9465246636771301
Test Acc: 0.6204299118336973	Test AUC: 0.7931392931392931
Itr: 0	Epoch: 7	Train Acc: 0.7549353374443303	Train AUC: 0.9440582959641256
Test Acc: 0.5088874059694249	Test AUC: 0.8045738045738046
Itr: 0	Epoch: 8	Train Acc: 0.759399623158616	Train AUC: 0.9496636771300448
Test Acc: 0.7361582949122382	Test AUC: 0.7946985446985447
Itr: 0	Epoch: 9	Train Acc: 0.7637461459403906	Train AUC: 0.9495515695067264
Test Acc: 0.6642805144382431	Test AUC: 0.8014553014553014
Itr: 0	Epoch: 10	Train Acc: 0.7676537341555327	Train AUC: 0.9480941704035873
Test Acc: 0.7053607538623311	Test AUC: 0.8045738045738047
Itr: 0	Epoch: 11	Train Acc: 0.7713043850633778	Train AUC: 0.958408071748879
Test Acc: 0.6297621936423198	Test AUC: 0.7577962577962578
Itr: 0	Epoch: 12	Train Acc: 0.7750192702980473	Train AUC: 0.9607623318385651
Test Acc: 0.5808056297015287	Test AUC: 0.8097713097713097
Itr: 0	Epoch: 13	Train Acc: 0.776207605344296	Train AUC: 0.9594170403587444
Test Acc: 0.727675321523902	Test AUC: 0.83004158004158
Itr: 0	Epoch: 14	Train Acc: 0.780650479616307	Train AUC: 0.9613228699551569
Test Acc: 0.6853716735420206	Test AUC: 0.8648648648648649
Itr: 0	Epoch: 15	Train Acc: 0.7828130352860568	Train AUC: 0.9632286995515695
Test Acc: 0.6628346679608509	Test AUC: 0.8305613305613305
Itr: 0	Epoch: 16	Train Acc: 0.7864529804727647	Train AUC: 0.9634529147982063
Test Acc: 0.6948252851249697	Test AUC: 0.8471933471933473
Itr: 0	Epoch: 17	Train Acc: 0.7849434737923947	Train AUC: 0.9660313901345292
Test Acc: 0.7493023537976219	Test AUC: 0.7822245322245321
Itr: 0	Epoch: 18	Train Acc: 0.7889045906132237	Train AUC: 0.9655829596412556
Test Acc: 0.7423461134028957	Test AUC: 0.7593555093555094
Itr: 0	Epoch: 19	Train Acc: 0.7913776121959575	Train AUC: 0.9654708520179373
Test Acc: 0.7155019008331311	Test AUC: 0.6772349272349273
Itr: 0	Epoch: 20	Train Acc: 0.7907031517643028	Train AUC: 0.9672645739910314
Test Acc: 0.7539128852220335	Test AUC: 0.7328482328482329
Itr: 0	Epoch: 21	Train Acc: 0.7932189962315862	Train AUC: 0.9698430493273542
Test Acc: 0.6977473105233357	Test AUC: 0.8154885654885654
Itr: 0	Epoch: 22	Train Acc: 0.7960560123329907	Train AUC: 0.9697309417040358
Test Acc: 0.7427404351694572	Test AUC: 0.775987525987526
Itr: 0	Epoch: 23	Train Acc: 0.7954457862281603	Train AUC: 0.9701793721973094
Test Acc: 0.6321382350562161	Test AUC: 0.7385654885654885
Itr: 0	Epoch: 24	Train Acc: 0.7974156389174375	Train AUC: 0.9688340807174887
Test Acc: 0.7524265954865323	Test AUC: 0.7707900207900209
Itr: 0	Epoch: 25	Train Acc: 0.7981329222336416	Train AUC: 0.9737668161434978
Test Acc: 0.5855273800857397	Test AUC: 0.7084199584199585
Itr: 0	Epoch: 26	Train Acc: 0.7981543336759164	Train AUC: 0.9725336322869955
Test Acc: 0.738281565962954	Test AUC: 0.7375259875259875
Itr: 0	Epoch: 27	Train Acc: 0.8655468482356972	Train AUC: 0.9860986547085202
Test Acc: 0.746107336407021	Test AUC: 0.8144490644490644
Itr: 0	Epoch: 28	Train Acc: 0.878447242206235	Train AUC: 0.993273542600897
Test Acc: 0.69122583515328	Test AUC: 0.8284823284823285
Itr: 0	Epoch: 29	Train Acc: 0.8823976533059267	Train AUC: 0.9949551569506727
Test Acc: 0.7312646606810644	Test AUC: 0.8154885654885655
Itr: 0	Epoch: 30	Train Acc: 0.8864765330592669	Train AUC: 0.9978699551569506
Test Acc: 0.7353494297500607	Test AUC: 0.7765072765072765
Itr: 0	Epoch: 31	Train Acc: 0.8890566118533745	Train AUC: 0.9980941704035875
Test Acc: 0.7119327833050231	Test AUC: 0.8035343035343036
Itr: 0	Epoch: 32	Train Acc: 0.8908444672833162	Train AUC: 0.9989910313901346
Test Acc: 0.6966047884817601	Test AUC: 0.8321205821205822
Itr: 0	Epoch: 33	Train Acc: 0.892717968482357	Train AUC: 0.998542600896861
Test Acc: 0.7147638113726442	Test AUC: 0.739085239085239
Itr: 0	Epoch: 34	Train Acc: 0.8959403905447071	Train AUC: 0.9996636771300448
Test Acc: 0.7469465340127801	Test AUC: 0.8347193347193348
Itr: 0	Epoch: 35	Train Acc: 0.8976533059266872	Train AUC: 0.9991031390134529
Test Acc: 0.64088408962226	Test AUC: 0.7806652806652807
Itr: 0	Epoch: 36	Train Acc: 0.8974498972250771	Train AUC: 0.9994394618834082
Test Acc: 0.6347367143897112	Test AUC: 0.8154885654885655
Itr: 0	Epoch: 37	Train Acc: 0.8998586844809866	Train AUC: 0.9998878923766816
Test Acc: 0.7140964976138477	Test AUC: 0.8373180873180873
Itr: 0	Epoch: 38	Train Acc: 0.9001156217882836	Train AUC: 0.9998878923766816
Test Acc: 0.6875859419234813	Test AUC: 0.8357588357588358
Itr: 0	Epoch: 39	Train Acc: 0.9025244090441932	Train AUC: 1.0
Test Acc: 0.6591947747310524	Test AUC: 0.8352390852390852
Itr: 0	Epoch: 40	Train Acc: 0.9030061664953751	Train AUC: 0.9998878923766816
Test Acc: 0.728605516460406	Test AUC: 0.833160083160083
Itr: 0	Epoch: 41	Train Acc: 0.9066461116820829	Train AUC: 1.0
Test Acc: 0.6722781687292728	Test AUC: 0.8274428274428275
Itr: 0	Epoch: 42	Train Acc: 0.9083483213429256	Train AUC: 0.9996636771300449
Test Acc: 0.6757967321847448	Test AUC: 0.8217255717255717
Itr: 0	Epoch: 43	Train Acc: 0.910264645426516	Train AUC: 1.0
Test Acc: 0.6713783062363504	Test AUC: 0.8227650727650728
Itr: 0	Epoch: 44	Train Acc: 0.9104466426858513	Train AUC: 1.0
Test Acc: 0.6835719485561756	Test AUC: 0.8477130977130977
Itr: 0	Epoch: 45	Train Acc: 0.9109176944158959	Train AUC: 1.0
Test Acc: 0.661398932297986	Test AUC: 0.8326403326403327
Itr: 0	Epoch: 46	Train Acc: 0.9131123672490579	Train AUC: 1.0
Test Acc: 0.6459597185149235	Test AUC: 0.831081081081081
Itr: 0	Epoch: 47	Train Acc: 0.91379753340185	Train AUC: 1.0
Test Acc: 0.6595284316104505	Test AUC: 0.8357588357588358
Itr: 0	Epoch: 48	Train Acc: 0.9139152963343611	Train AUC: 1.0
Test Acc: 0.692156030089784	Test AUC: 0.8944906444906445
Itr: 0	Epoch: 49	Train Acc: 0.9156817403220281	Train AUC: 1.0
Test Acc: 0.7530939092453288	Test AUC: 0.8113305613305614
Saving {path_to_buffer_storage}/CRC/ResNet18/replay_buffer_0.pt
Itr: 1	Epoch: 0	Train Acc: 0.5591491092840014	Train AUC: 0.7225336322869955
Test Acc: 0.7011445442044811	Test AUC: 0.6377338877338877
Itr: 1	Epoch: 1	Train Acc: 0.6544300274066461	Train AUC: 0.8669282511210763
Test Acc: 0.7053506430478039	Test AUC: 0.7193347193347193
Itr: 1	Epoch: 2	Train Acc: 0.7015352004110997	Train AUC: 0.9032511210762331
Test Acc: 0.6497411631481033	Test AUC: 0.7016632016632016
Itr: 1	Epoch: 3	Train Acc: 0.7250877869133264	Train AUC: 0.9265695067264573
Test Acc: 0.6995065922510717	Test AUC: 0.7021829521829522
Itr: 1	Epoch: 4	Train Acc: 0.7434588043850634	Train AUC: 0.9364349775784754
Test Acc: 0.6580724743185311	Test AUC: 0.7536382536382537
Itr: 1	Epoch: 5	Train Acc: 0.7505138746145941	Train AUC: 0.9381165919282511
Test Acc: 0.6908820674593545	Test AUC: 0.7338877338877339
Itr: 1	Epoch: 6	Train Acc: 0.7562628468653648	Train AUC: 0.9449551569506727
Test Acc: 0.7496865647496562	Test AUC: 0.7910602910602911
Itr: 1	Epoch: 7	Train Acc: 0.7628575710859884	Train AUC: 0.95
Test Acc: 0.4922551160721508	Test AUC: 0.7349272349272349
Itr: 1	Epoch: 8	Train Acc: 0.7670328023295649	Train AUC: 0.9544843049327354
Test Acc: 0.6923784680093829	Test AUC: 0.75
Itr: 1	Epoch: 9	Train Acc: 0.7701588729016786	Train AUC: 0.9540358744394619
Test Acc: 0.6709940952843161	Test AUC: 0.8144490644490645
Itr: 1	Epoch: 10	Train Acc: 0.7771604145255224	Train AUC: 0.958408071748879
Test Acc: 0.6541191458383887	Test AUC: 0.818087318087318
Itr: 1	Epoch: 11	Train Acc: 0.7792908530318602	Train AUC: 0.9586322869955157
Test Acc: 0.7054517511930761	Test AUC: 0.8191268191268191
Itr: 1	Epoch: 12	Train Acc: 0.7807575368276807	Train AUC: 0.9616591928251121
Test Acc: 0.6539068187333171	Test AUC: 0.8024948024948025
Itr: 1	Epoch: 13	Train Acc: 0.7837337273038711	Train AUC: 0.9619955156950672
Test Acc: 0.7313556580118095	Test AUC: 0.7515592515592515
Itr: 1	Epoch: 14	Train Acc: 0.7876520212401508	Train AUC: 0.9621076233183856
Test Acc: 0.5740212731537653	Test AUC: 0.7635135135135136
Itr: 1	Epoch: 15	Train Acc: 0.7887868276807126	Train AUC: 0.9645739910313901
Test Acc: 0.748099166868883	Test AUC: 0.803014553014553
Itr: 1	Epoch: 16	Train Acc: 0.79181654676259	Train AUC: 0.9690582959641256
Test Acc: 0.7181913774973712	Test AUC: 0.8222453222453223
Itr: 1	Epoch: 17	Train Acc: 0.7917737238780405	Train AUC: 0.9678251121076233
Test Acc: 0.6788805306155464	Test AUC: 0.761954261954262
Itr: 1	Epoch: 18	Train Acc: 0.7943430969510106	Train AUC: 0.967713004484305
Test Acc: 0.6704885545579552	Test AUC: 0.7910602910602911
Itr: 1	Epoch: 19	Train Acc: 0.7936365193559438	Train AUC: 0.970627802690583
Test Acc: 0.6820148831189841	Test AUC: 0.7198544698544699
Itr: 1	Epoch: 20	Train Acc: 0.7973835217540254	Train AUC: 0.9701793721973094
Test Acc: 0.7018826336649681	Test AUC: 0.7744282744282744
Itr: 1	Epoch: 21	Train Acc: 0.7977046933881466	Train AUC: 0.97152466367713
Test Acc: 0.5718474480304133	Test AUC: 0.7920997920997921
Itr: 1	Epoch: 22	Train Acc: 0.7958954265159301	Train AUC: 0.9738789237668161
Test Acc: 0.5632532556822778	Test AUC: 0.83004158004158
Itr: 1	Epoch: 23	Train Acc: 0.8010662898252826	Train AUC: 0.9714125560538116
Test Acc: 0.7089298713904392	Test AUC: 0.7713097713097713
Itr: 1	Epoch: 24	Train Acc: 0.8020083932853717	Train AUC: 0.9752242152466367
Test Acc: 0.7253599449971689	Test AUC: 0.7484407484407485
Itr: 1	Epoch: 25	Train Acc: 0.7992998458376156	Train AUC: 0.9745515695067264
Test Acc: 0.5690770848499556	Test AUC: 0.7375259875259875
Itr: 1	Epoch: 26	Train Acc: 0.8032502569373073	Train AUC: 0.9755605381165919
Test Acc: 0.7470071988999434	Test AUC: 0.711018711018711
Itr: 1	Epoch: 27	Train Acc: 0.8697327852004111	Train AUC: 0.9869955156950674
Test Acc: 0.7218312707271698	Test AUC: 0.8123700623700624
Itr: 1	Epoch: 28	Train Acc: 0.8804813292223365	Train AUC: 0.9933856502242153
Test Acc: 0.7124585456604384	Test AUC: 0.816008316008316
Itr: 1	Epoch: 29	Train Acc: 0.8872259335388831	Train AUC: 0.9964125560538116
Test Acc: 0.6784053223327672	Test AUC: 0.8113305613305613
Itr: 1	Epoch: 30	Train Acc: 0.8906196471394313	Train AUC: 0.9974215246636772
Test Acc: 0.715774892825366	Test AUC: 0.7983367983367984
Itr: 1	Epoch: 31	Train Acc: 0.8925787941075711	Train AUC: 0.9978699551569506
Test Acc: 0.7567439132896546	Test AUC: 0.8191268191268191
Itr: 1	Epoch: 32	Train Acc: 0.8943345323741008	Train AUC: 0.9982062780269059
Test Acc: 0.732124079915878	Test AUC: 0.8050935550935552
Itr: 1	Epoch: 33	Train Acc: 0.8969039054470709	Train AUC: 0.9980941704035875
Test Acc: 0.6453328480142361	Test AUC: 0.7920997920997921
Itr: 1	Epoch: 34	Train Acc: 0.8973535457348407	Train AUC: 0.9989910313901346
Test Acc: 0.6790726360915635	Test AUC: 0.8175675675675675
Itr: 1	Epoch: 35	Train Acc: 0.9003725590955807	Train AUC: 0.9993273542600897
Test Acc: 0.6808925827064628	Test AUC: 0.7946985446985446
Itr: 1	Epoch: 36	Train Acc: 0.9019570058239123	Train AUC: 0.9998878923766816
Test Acc: 0.7429932055326377	Test AUC: 0.7926195426195426
Itr: 1	Epoch: 37	Train Acc: 0.9014003083247688	Train AUC: 0.9997757847533632
Test Acc: 0.7540139933673057	Test AUC: 0.8326403326403327
Itr: 1	Epoch: 38	Train Acc: 0.9050188420692018	Train AUC: 0.9998878923766816
Test Acc: 0.7556317236916607	Test AUC: 0.7972972972972973
Itr: 1	Epoch: 39	Train Acc: 0.9060251798561151	Train AUC: 0.9998878923766816
Test Acc: 0.7246319663512093	Test AUC: 0.7915800415800416
Itr: 1	Epoch: 40	Train Acc: 0.9071278691332648	Train AUC: 1.0
Test Acc: 0.6885464693035671	Test AUC: 0.8118503118503119
Itr: 1	Epoch: 41	Train Acc: 0.9074276293251113	Train AUC: 1.0
Test Acc: 0.66825406454744	Test AUC: 0.844074844074844
Itr: 1	Epoch: 42	Train Acc: 0.9093439534087016	Train AUC: 1.0
Test Acc: 0.7253700558116962	Test AUC: 0.8471933471933472
Itr: 1	Epoch: 43	Train Acc: 0.9108213429256595	Train AUC: 1.0
Test Acc: 0.6749474237644585	Test AUC: 0.8445945945945946
Itr: 1	Epoch: 44	Train Acc: 0.9127483727303871	Train AUC: 1.0
Test Acc: 0.7614555528593383	Test AUC: 0.841995841995842
Itr: 1	Epoch: 45	Train Acc: 0.9128661356628982	Train AUC: 1.0
Test Acc: 0.6715198576397314	Test AUC: 0.8300415800415799
Itr: 1	Epoch: 46	Train Acc: 0.9128233127783487	Train AUC: 1.0
Test Acc: 0.7738109682115991	Test AUC: 0.8238045738045738
Itr: 1	Epoch: 47	Train Acc: 0.9155532716683796	Train AUC: 1.0
Test Acc: 0.7547723044568471	Test AUC: 0.8357588357588358
Itr: 1	Epoch: 48	Train Acc: 0.9151036313806098	Train AUC: 1.0
Test Acc: 0.7091118660519291	Test AUC: 0.8102910602910602
Itr: 1	Epoch: 49	Train Acc: 0.916420435080507	Train AUC: 1.0
Test Acc: 0.71536034942975	Test AUC: 0.8232848232848233
Saving {path_to_buffer_storage}/CRC/ResNet18/replay_buffer_1.pt
Itr: 2	Epoch: 0	Train Acc: 0.5404462144570058	Train AUC: 0.6897982062780269
Test Acc: 0.6991527137426191	Test AUC: 0.5878378378378379
Itr: 2	Epoch: 1	Train Acc: 0.6348920863309353	Train AUC: 0.8312780269058296
Test Acc: 0.5461154250586427	Test AUC: 0.7692307692307693
Itr: 2	Epoch: 2	Train Acc: 0.6925531003768414	Train AUC: 0.8988789237668161
Test Acc: 0.5198171964733479	Test AUC: 0.6923076923076923
Itr: 2	Epoch: 3	Train Acc: 0.7223792394655704	Train AUC: 0.9220852017937219
Test Acc: 0.66825406454744	Test AUC: 0.8108108108108107
Itr: 2	Epoch: 4	Train Acc: 0.7401293251113396	Train AUC: 0.9367713004484305
Test Acc: 0.6559795357113969	Test AUC: 0.8274428274428274
Itr: 2	Epoch: 5	Train Acc: 0.7480515587529976	Train AUC: 0.9410313901345291
Test Acc: 0.7320735258432419	Test AUC: 0.7162162162162162
Itr: 2	Epoch: 6	Train Acc: 0.7527192531688934	Train AUC: 0.9413677130044843
Test Acc: 0.5030130227291111	Test AUC: 0.840956340956341
Itr: 2	Epoch: 7	Train Acc: 0.7590891572456321	Train AUC: 0.9467488789237668
Test Acc: 0.7111340289573728	Test AUC: 0.7962577962577962
Itr: 2	Epoch: 8	Train Acc: 0.7647953066118534	Train AUC: 0.9505605381165919
Test Acc: 0.6734409123999029	Test AUC: 0.8316008316008316
Itr: 2	Epoch: 9	Train Acc: 0.7687885405960946	Train AUC: 0.9542600896860987
Test Acc: 0.7304355738898326	Test AUC: 0.6891891891891891
Itr: 2	Epoch: 10	Train Acc: 0.7743876327509421	Train AUC: 0.9578475336322869
Test Acc: 0.6082868235865081	Test AUC: 0.751039501039501
Itr: 2	Epoch: 11	Train Acc: 0.7793657930798219	Train AUC: 0.9637892376681614
Test Acc: 0.6755035185634555	Test AUC: 0.8362785862785863
Itr: 2	Epoch: 12	Train Acc: 0.7827702124015073	Train AUC: 0.9633408071748879
Test Acc: 0.6507825770444067	Test AUC: 0.7146569646569647
Itr: 2	Epoch: 13	Train Acc: 0.7841619561493662	Train AUC: 0.9625560538116592
Test Acc: 0.7363605112027825	Test AUC: 0.7806652806652807
Itr: 2	Epoch: 14	Train Acc: 0.7857249914354231	Train AUC: 0.9649103139013453
Test Acc: 0.7254206098843323	Test AUC: 0.826923076923077
Itr: 2	Epoch: 15	Train Acc: 0.7882301301815691	Train AUC: 0.9696188340807175
Test Acc: 0.6792950740111623	Test AUC: 0.8393970893970895
Itr: 2	Epoch: 16	Train Acc: 0.7902642171976705	Train AUC: 0.9691704035874439
Test Acc: 0.6708222114373534	Test AUC: 0.761954261954262
Itr: 2	Epoch: 17	Train Acc: 0.7922661870503597	Train AUC: 0.9640134529147982
Test Acc: 0.7579268785893392	Test AUC: 0.7624740124740125
Itr: 2	Epoch: 18	Train Acc: 0.7923518328194588	Train AUC: 0.970627802690583
Test Acc: 0.7127922025398367	Test AUC: 0.8643451143451144
Itr: 2	Epoch: 19	Train Acc: 0.7960881294964028	Train AUC: 0.9707399103139014
Test Acc: 0.7360268543233843	Test AUC: 0.7681912681912683
Itr: 2	Epoch: 20	Train Acc: 0.7960453066118534	Train AUC: 0.9717488789237668
Test Acc: 0.6974136536439376	Test AUC: 0.827962577962578
Itr: 2	Epoch: 21	Train Acc: 0.7968268242548818	Train AUC: 0.9724215246636772
Test Acc: 0.6160418183288846	Test AUC: 0.8087318087318087
Itr: 2	Epoch: 22	Train Acc: 0.7998351318944844	Train AUC: 0.9741031390134529
Test Acc: 0.7135606244439052	Test AUC: 0.7198544698544699
Itr: 2	Epoch: 23	Train Acc: 0.7980686879068174	Train AUC: 0.9730941704035874
Test Acc: 0.7099308420286339	Test AUC: 0.8076923076923077
/home/intern/anaconda3/envs/distillation_ct/lib/python3.9/site-packages/torch/functional.py:568: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  /opt/conda/conda-bld/pytorch_1646756402876/work/aten/src/ATen/native/TensorShape.cpp:2228.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
Itr: 2	Epoch: 24	Train Acc: 0.7989465570400822	Train AUC: 0.972085201793722
Test Acc: 0.7226805791474561	Test AUC: 0.8367983367983368
Hyper-parameters: 
 {'dataset': 'CRC', 'subset': 'imagenette', 'model': 'ResNet18', 'num_experts': 10, 'lr_teacher': 0.0001, 'batch_train': 16, 'batch_real': 16, 'dsa': True, 'dsa_strategy': 'color_crop_cutout_flip_scale_rotate', 'data_path': '{path_to_dataset}', 'buffer_path': 'buffer2', 'train_epochs': 50, 'zca': False, 'decay': True, 'mom': 0.9, 'l2': 0.01, 'save_interval': 1, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7fbcda690fa0>}
BUILDING DATASET
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'crop_scale_rotate'}
Itr: 2	Epoch: 25	Train Acc: 0.8013018156903049	Train AUC: 0.9730941704035875
Test Acc: 0.5837377659144221	Test AUC: 0.825883575883576
Itr: 2	Epoch: 26	Train Acc: 0.8016872216512504	Train AUC: 0.973206278026906
Test Acc: 0.5995207473914098	Test AUC: 0.7733887733887734
Itr: 2	Epoch: 27	Train Acc: 0.8693152620760535	Train AUC: 0.9883408071748879
Test Acc: 0.6538764862897355	Test AUC: 0.818087318087318
Itr: 2	Epoch: 28	Train Acc: 0.8835538711887633	Train AUC: 0.992713004484305
Test Acc: 0.731709536520262	Test AUC: 0.8232848232848233
Itr: 2	Epoch: 29	Train Acc: 0.8876862795477903	Train AUC: 0.995964125560538
Test Acc: 0.7163613200679447	Test AUC: 0.8643451143451144
Itr: 2	Epoch: 30	Train Acc: 0.8910478759849263	Train AUC: 0.9980941704035875
Test Acc: 0.6972417697969748	Test AUC: 0.8264033264033264
Itr: 2	Epoch: 31	Train Acc: 0.8958333333333334	Train AUC: 0.9991031390134528
Test Acc: 0.691832484024913	Test AUC: 0.8191268191268191
Itr: 2	Epoch: 32	Train Acc: 0.8967540253511477	Train AUC: 0.9995515695067264
Test Acc: 0.6543213621289331	Test AUC: 0.83004158004158
Itr: 2	Epoch: 33	Train Acc: 0.8988630524152107	Train AUC: 0.999439461883408
Test Acc: 0.7150570249939335	Test AUC: 0.8128898128898129
Itr: 2	Epoch: 34	Train Acc: 0.900126327509421	Train AUC: 0.9997757847533632
Test Acc: 0.6994762598074901	Test AUC: 0.8154885654885655
Itr: 2	Epoch: 35	Train Acc: 0.9027706406303528	Train AUC: 0.9992152466367713
Test Acc: 0.7159973307449649	Test AUC: 0.853950103950104
Itr: 2	Epoch: 36	Train Acc: 0.9047190818773553	Train AUC: 0.9995515695067264
Test Acc: 0.6925604626708728	Test AUC: 0.8456340956340958
Itr: 2	Epoch: 37	Train Acc: 0.9057468311065433	Train AUC: 1.0
Test Acc: 0.7671883846962712	Test AUC: 0.8258835758835759
Itr: 2	Epoch: 38	Train Acc: 0.9079522096608428	Train AUC: 1.0
Test Acc: 0.7033082585133058	Test AUC: 0.8206860706860707
Itr: 2	Epoch: 39	Train Acc: 0.9098578280232956	Train AUC: 1.0
Test Acc: 0.7353393189355334	Test AUC: 0.8336798336798337
Itr: 2	Epoch: 40	Train Acc: 0.9102432339842412	Train AUC: 0.9998878923766816
Test Acc: 0.7420528997816064	Test AUC: 0.8523908523908524
Itr: 2	Epoch: 41	Train Acc: 0.9112709832134293	Train AUC: 1.0
Test Acc: 0.6460810482892502	Test AUC: 0.798856548856549
Itr: 2	Epoch: 42	Train Acc: 0.9139688249400479	Train AUC: 1.0
Test Acc: 0.745318692873898	Test AUC: 0.838877338877339
Itr: 2	Epoch: 43	Train Acc: 0.9148359883521754	Train AUC: 1.0
Test Acc: 0.7420933430397153	Test AUC: 0.8497920997920998
Itr: 2	Epoch: 44	Train Acc: 0.9151036313806098	Train AUC: 1.0
Test Acc: 0.7687151176898811	Test AUC: 0.8721413721413721
Itr: 2	Epoch: 45	Train Acc: 0.9166880781089414	Train AUC: 1.0
Test Acc: 0.7605860228099975	Test AUC: 0.832120582120582
Itr: 2	Epoch: 46	Train Acc: 0.9179406474820144	Train AUC: 1.0
Test Acc: 0.7473509665938688	Test AUC: 0.8383575883575883
Itr: 2	Epoch: 47	Train Acc: 0.9195679170948955	Train AUC: 1.0
Test Acc: 0.6426635929790504	Test AUC: 0.7843035343035343
Itr: 2	Epoch: 48	Train Acc: 0.9199426173347036	Train AUC: 1.0
Test Acc: 0.7505459839844698	Test AUC: 0.8674636174636174
Itr: 2	Epoch: 49	Train Acc: 0.9204671976704351	Train AUC: 1.0
Test Acc: 0.7632552778451832	Test AUC: 0.8804573804573804
Saving {path_to_buffer_storage}/CRC/ResNet18/replay_buffer_2.pt
Itr: 3	Epoch: 0	Train Acc: 0.5560016272696129	Train AUC: 0.6975336322869955
Test Acc: 0.593969910215967	Test AUC: 0.6444906444906444
Itr: 3	Epoch: 1	Train Acc: 0.6482849434737924	Train AUC: 0.8457399103139015
Test Acc: 0.5636273558197848	Test AUC: 0.7141372141372142
Itr: 3	Epoch: 2	Train Acc: 0.6976383179170949	Train AUC: 0.8980941704035875
Test Acc: 0.573546064870986	Test AUC: 0.7219334719334719
Itr: 3	Epoch: 3	Train Acc: 0.7279569201781432	Train AUC: 0.9233183856502242
Test Acc: 0.6683046186200761	Test AUC: 0.725051975051975
Itr: 3	Epoch: 4	Train Acc: 0.7394120417951353	Train AUC: 0.9309417040358745
Test Acc: 0.5531727735986411	Test AUC: 0.8222453222453222
Itr: 3	Epoch: 5	Train Acc: 0.7482656731757451	Train AUC: 0.9380044843049328
Test Acc: 0.673208363665777	Test AUC: 0.7427234927234927
Itr: 3	Epoch: 6	Train Acc: 0.750738694758479	Train AUC: 0.9404708520179372
Test Acc: 0.6681428455876406	Test AUC: 0.7962577962577961
Itr: 3	Epoch: 7	Train Acc: 0.7554278006166495	Train AUC: 0.943609865470852
Test Acc: 0.631531586184583	Test AUC: 0.8430353430353431
Itr: 3	Epoch: 8	Train Acc: 0.7621616992120589	Train AUC: 0.9423766816143498
Test Acc: 0.7450052576235542	Test AUC: 0.7198544698544699
Itr: 3	Epoch: 9	Train Acc: 0.7661656389174375	Train AUC: 0.9497757847533632
Test Acc: 0.5633948070856588	Test AUC: 0.760914760914761
Itr: 3	Epoch: 10	Train Acc: 0.768146197327852	Train AUC: 0.9516816143497758
Test Acc: 0.6591846639165251	Test AUC: 0.7146569646569647
Itr: 3	Epoch: 11	Train Acc: 0.7731457690990066	Train AUC: 0.9571748878923767
Test Acc: 0.7059775135484915	Test AUC: 0.7697505197505198
Itr: 3	Epoch: 12	Train Acc: 0.7750835046248715	Train AUC: 0.9557174887892377
Test Acc: 0.7411227048451023	Test AUC: 0.751039501039501
Itr: 3	Epoch: 13	Train Acc: 0.7795049674546077	Train AUC: 0.9607623318385651
Test Acc: 0.7341563536358489	Test AUC: 0.7920997920997921
Itr: 3	Epoch: 14	Train Acc: 0.7803935423090099	Train AUC: 0.9613228699551569
Test Acc: 0.7559552697565316	Test AUC: 0.7988565488565488
Itr: 3	Epoch: 15	Train Acc: 0.7832412641315519	Train AUC: 0.9627802690582961
Test Acc: 0.7301726927121249	Test AUC: 0.7863825363825363
Itr: 3	Epoch: 16	Train Acc: 0.7873843782117164	Train AUC: 0.9637892376681614
Test Acc: 0.6631784356547763	Test AUC: 0.7733887733887734
Itr: 3	Epoch: 17	Train Acc: 0.7865921548475505	Train AUC: 0.9650224215246637
Test Acc: 0.6769089217827389	Test AUC: 0.7952182952182952
Itr: 3	Epoch: 18	Train Acc: 0.7928014731072285	Train AUC: 0.9672645739910314
Test Acc: 0.6996279220253984	Test AUC: 0.8243243243243243
Itr: 3	Epoch: 19	Train Acc: 0.7906068002740665	Train AUC: 0.9693946188340807
Test Acc: 0.5990354282941034	Test AUC: 0.8087318087318087
Itr: 3	Epoch: 20	Train Acc: 0.7935294621445701	Train AUC: 0.9707399103139014
Test Acc: 0.5519999191134838	Test AUC: 0.7832640332640333
Itr: 3	Epoch: 21	Train Acc: 0.794096865364851	Train AUC: 0.9702914798206278
Test Acc: 0.660569845506754	Test AUC: 0.7817047817047816
Itr: 3	Epoch: 22	Train Acc: 0.7960774237752655	Train AUC: 0.9687219730941704
Test Acc: 0.59341381541697	Test AUC: 0.5883575883575883
Itr: 3	Epoch: 23	Train Acc: 0.796719767043508	Train AUC: 0.9711883408071749
Test Acc: 0.7251375070775702	Test AUC: 0.6959459459459459
Itr: 3	Epoch: 24	Train Acc: 0.7998779547790339	Train AUC: 0.9719730941704036
Test Acc: 0.6677485238210791	Test AUC: 0.7494802494802495
Itr: 3	Epoch: 25	Train Acc: 0.7998030147310723	Train AUC: 0.9725336322869955
Test Acc: 0.6269614980182804	Test AUC: 0.8814968814968815
Itr: 3	Epoch: 26	Train Acc: 0.8011947584789312	Train AUC: 0.973542600896861
Test Acc: 0.6860794305589258	Test AUC: 0.79002079002079
Itr: 3	Epoch: 27	Train Acc: 0.8681269270298048	Train AUC: 0.9871076233183858
Test Acc: 0.7198394402653078	Test AUC: 0.829002079002079
Itr: 3	Epoch: 28	Train Acc: 0.8813591983556013	Train AUC: 0.9929372197309417
Test Acc: 0.722397476340694	Test AUC: 0.829002079002079
Itr: 3	Epoch: 29	Train Acc: 0.8855344295991778	Train AUC: 0.9956278026905829
Test Acc: 0.7367851654129257	Test AUC: 0.7920997920997921
Itr: 3	Epoch: 30	Train Acc: 0.8911870503597122	Train AUC: 0.9971973094170403
Test Acc: 0.7096072959637628	Test AUC: 0.8186070686070687
Itr: 3	Epoch: 31	Train Acc: 0.8917544535799932	Train AUC: 0.9982062780269059
Test Acc: 0.700446898002103	Test AUC: 0.7988565488565489
Itr: 3	Epoch: 32	Train Acc: 0.895169578622816	Train AUC: 0.9986547085201793
Test Acc: 0.6931570007279787	Test AUC: 0.725051975051975
Itr: 3	Epoch: 33	Train Acc: 0.8959296848235697	Train AUC: 0.9991031390134529
Test Acc: 0.7740131845021435	Test AUC: 0.8326403326403327
Itr: 3	Epoch: 34	Train Acc: 0.8982421205892429	Train AUC: 0.9988789237668161
Test Acc: 0.6857053304214188	Test AUC: 0.7910602910602911
Itr: 3	Epoch: 35	Train Acc: 0.9005438506337787	Train AUC: 0.9995515695067264
Test Acc: 0.7329733883361643	Test AUC: 0.8523908523908524
Itr: 3	Epoch: 36	Train Acc: 0.9006509078451524	Train AUC: 0.9998878923766816
Test Acc: 0.7498281161530372	Test AUC: 0.8809771309771309
Itr: 3	Epoch: 37	Train Acc: 0.9023210003425831	Train AUC: 0.9997757847533632
Test Acc: 0.7092837498988919	Test AUC: 0.814968814968815
Itr: 3	Epoch: 38	Train Acc: 0.9032845152449469	Train AUC: 1.0
Test Acc: 0.6953813799239666	Test AUC: 0.8570686070686071
Itr: 3	Epoch: 39	Train Acc: 0.9056718910585817	Train AUC: 1.0
Test Acc: 0.6942186362533366	Test AUC: 0.8071725571725572
Itr: 3	Epoch: 40	Train Acc: 0.9092261904761905	Train AUC: 1.0
Test Acc: 0.6363746663431206	Test AUC: 0.8154885654885655
Itr: 3	Epoch: 41	Train Acc: 0.9084018499486125	Train AUC: 1.0
Test Acc: 0.7586043031626628	Test AUC: 0.8601871101871101
Itr: 3	Epoch: 42	Train Acc: 0.9107999314833847	Train AUC: 0.9996636771300449
Test Acc: 0.7245713014640459	Test AUC: 0.8045738045738047
Itr: 3	Epoch: 43	Train Acc: 0.9107035799931483	Train AUC: 1.0
Test Acc: 0.7243994176170833	Test AUC: 0.872141372141372
Itr: 3	Epoch: 44	Train Acc: 0.9123522610483042	Train AUC: 1.0
Test Acc: 0.7386657769149882	Test AUC: 0.8648648648648649
Itr: 3	Epoch: 45	Train Acc: 0.9143435251798561	Train AUC: 1.0
Test Acc: 0.7201124322575426	Test AUC: 0.8659043659043659
Itr: 3	Epoch: 46	Train Acc: 0.9156924460431655	Train AUC: 1.0
Test Acc: 0.7558642724257866	Test AUC: 0.7952182952182951
Itr: 3	Epoch: 47	Train Acc: 0.9147182254196643	Train AUC: 1.0
Test Acc: 0.700446898002103	Test AUC: 0.8321205821205822
Itr: 3	Epoch: 48	Train Acc: 0.9179406474820144	Train AUC: 1.0
Test Acc: 0.644635201811858	Test AUC: 0.8321205821205822
Itr: 3	Epoch: 49	Train Acc: 0.9171270126755738	Train AUC: 1.0
Test Acc: 0.7544588692065033	Test AUC: 0.8196465696465697
Saving {path_to_buffer_storage}/CRC/ResNet18/replay_buffer_3.pt
Itr: 4	Epoch: 0	Train Acc: 0.5501991264131552	Train AUC: 0.7469730941704036
Test Acc: 0.4970880854161611	Test AUC: 0.659043659043659
./sh_file/buffer_CRC.sh: line 2: 2624959 Killed                  CUDA_VISIBLE_DEVICES=0,1,2,3 python buffer.py --dataset=CRC --model=ResNet18 --train_epochs=50 --num_experts=10 --lr_teacher=0.001 --batch_train=16 --batch_real=16 --decay --mom=0.9 --l2=0.01 --save_interval=1 --buffer_path={path_to_buffer_storage} --data_path={path_to_dataset}
